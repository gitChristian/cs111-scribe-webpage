<!DOCTYPE HTML>
<!--
	Read Only by HTML5 UP
	html5up.net | @n33co
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>CS 111 Lecture 14</title>
		<meta http-equiv="content-type" content="text/html; charset=utf-8" />
		<meta name="description" content="" />
		<meta name="keywords" content="" />
		<!--[if lte IE 8]><script src="css/ie/html5shiv.js"></script><![endif]-->
		<script src="js/jquery.min.js"></script>
		<script src="js/jquery.scrollzer.min.js"></script>
		<script src="js/jquery.scrolly.min.js"></script>
		<script src="js/skel.min.js"></script>
		<script src="js/skel-layers.min.js"></script>
		<script src="js/init.js"></script>
		<noscript>
			<link rel="stylesheet" href="css/skel.css" />
			<link rel="stylesheet" href="css/style.css" />
			<link rel="stylesheet" href="css/style-xlarge.css" />
		</noscript>
		<!--[if lte IE 8]><link rel="stylesheet" href="css/ie/v8.css" /><![endif]-->
	</head>
	<body>
		<div id="wrapper">

			<!-- Header -->
			<!-- We don' really need this
				<section id="header" class="skel-layers-fixed">
					<header>
						<span class="image avatar"><img src="images/avatar.jpg" alt="" /></span>
						<h1 id="logo"><a href="#">Willis Corto</a></h1>
						<p>I got reprogrammed by a rogue AI<br />
						and now I'm totally cray</p>
					</header>
					<nav id="nav">
						<ul>
							<li><a href="#one" class="active">About</a></li>
							<li><a href="#two">Things I Can Do</a></li>
							<li><a href="#three">A Few Accomplishments</a></li>
						</ul>
					</nav>
					
				</section>

			-->

			

					<!-- Heading-->
						<section id="one">
							<div class="container">
								<header class="major">
									<h2>File System Robustness: <br>CS111 Lecture 14</h2>
									<h4>By Christian Nersesyan, David Antonio Garcia, Victoria Bernard</h4>
								</header>
							</div>
						</section>
					<!-- Overview Navigation -->
							<section id="overview">
							<div class="container">
						<!--	<div class="features"> -->
							  <article>
								<h2>Overview</h2>
										<ol id="toc">
											<li><a href="#robustness_intro">Importance of Robustness</a></li>
											<li><a href="#robustness_intro">Example Problem: Current GNU tar Exploit</a>
												<ol>
													<li><a href="#robustness_intro">tar in General</a></li>
													<li><a href="#robustness_intro">Exploiting tar</a></li>
													
												</ol>
											</li>
										<!--	<li><a href="#thought_experiment">A Thought Experiment: Simple, Secure OS</a></li>
											<li><a href="#bootstrapping">Bootstrapping</a>
												<ol>
													<li><a href="#bios">BIOS</a></li>
													<li><a href="#chain_loading">Chain Loading</a></li>
												</ol>
											</li>
											<li><a href="#return_to_the_thought_experiment">Returning to the Thought Experiment</a></li>
											<li><a href="#programmed_io">Programmed I/O</a>
												<ol>
													<li><a href="#reading_ide_sectors">Reading IDE Sectors</a></li>
													<li><a href="#main_program">Main Program</a></li>
													<li><a href="#where_from_here">Where from Here?</a></li>
												</ol>
											</li> -->
										</ol>
								</div>
						</section>
						</article>
					<!-- Two -->
						<section id="two">
							<div class="container">
								<h3><a name="robustness_intro"></a>Typical File System</h3>
								<h4>Berkley Fast File System (BSD)</h4>
								<a href="#" class="image"><img src="images/BSD_diagram.jpg" alt="" /></a>
								<h3>Ways to evaluate a file system</h3>

								<p>Say you are the product manager of an operating system. How do you go about choosing a file system for your OS?
								How can you make sure the FS you choose is robust? We can test invariants. Invariants in this case are boolean expresssions
								that should always be true for the FS.</p>
								
								
								<h4>Invariants for a  FS</h4>
								<dl>
									<dt> 1. Each block in FS in used for only one purpose </dt>
									<dd>&emsp;&emsp; Ex. of purposes: superblock, free bitmap, inodes, etc. </dd>
									
									<dt>2. All reference blocks are initialized to data that are appropriate to that block.</dt>
									<dd>&emsp;&emsp; Never leave data in an invalid state. For example, don't initialize an inode with a negative file size.</dd>
									
									<dt>3. All reference data blocks are marked used in the bitmap.</dt>
									<dd></dd>
									
									<dt>4. All unreferenced data blocks are marked free in bitmap.</dt>
									<dd></dd>
								</dl>
								<p>Let's refer to the above invariants as the rules of our FS.</p>
								
								<h4>Consequences of breaking these rules</h4>
								<dl>
									<dt>1. Disaster </dt><dd></dd>
									<dt>2. Disaster</dt><dd></dd>
									<dt>2. Disaster</dt><dd></dd>
									<dt>4. We loose space in our FS (unused leak). <!-- Victoria added this line -->We are permanently marking a block as unuseable, so we are wasting memory space. </dt><dd></dd>
								</dl>
								<p>Rules 1-3 tend to have the highest prioty from developers since breaking these rules will corrupt the entire FS. 
								Rule 4, although important, has less devastating effects.</p>
								
								
								
							</div>
						</section>
						
					<!-- Three - Victoria -->
						<section >
							<div class="container">
								<h3>Performance Issues</h3>
								<p>Integer eu ante ornare amet commetus vestibulum blandit integer in curae ac faucibus integer non. Adipiscing cubilia elementum integer lorem ipsum dolor sit amet.</p>
								
								<h4>Problem 1 : Cache Coherence </h4>
								<dl><!--- It would be cool if I could change the font below-->
									<dt><h5> <i>Definition:</i> cache unintentionally differs from memory </h5></dt><dd></dd>
									<div style="font-family: Consolas; font-size: medium; ">
									<dt> &emsp;&emsp;&emsp; write(fd, "hello", s );  </dt><dd></dd>
									<dt> &emsp;&emsp;&emsp; read (fd, buffer, s ); </dt><dd></dd></div>
									<dt> Most OS use a process called <i> dallying - </i>  certain tasks are prioritized over prior tasks</dt>
									<dt> Suppose fd is a regular file on the disk. What if  kernel locks at cache? then data would never be copied back to disk</dt><dd></dd>							
									<dt> Why do we care so much? </dt><dd></dd>
									<dd>&emsp;&emsp; - cache may differ from disk causes invalid reads </dt><dd></dd>
									<dd>&emsp;&emsp; - write success notified to user was successful when maybe it wasn't. </dt><dd></dd>
									<dd>&emsp;&emsp; - some side effects may not be saved due to out of order writes </dd>
									<dd>&emsp;&emsp; -  </dd>
									<dt> Sources of this problem</dt><dd></dd>
									<dt> -  Power Loss </dt>
									<dt> -  Disk crash </dt>
									<dt> -  Suddend Disconnection </dt>
									
								</dl>
								<h5> Potential Solutions </h5>
								<dl><!--- It would be cool if I could change the font below-->
									<dt>1. Maintain a backup power supply in case of power loss to ensure cache always gets copied to disk.  </dt><dd></dd>
									<dt> fsync  </dt><dd></dd>
									<dt> read (fd, buffer, s ); </dt><dd></dd>
									<dt> Suppose fd is a regular file on the disk. What if  kernel locks at cache? then data would never be copied back to disk</dt><dd></dd>
									<dt> Why do we care so much? </dt><dd></dd>
									<dd>&emsp;&emsp; - write success notified to user was successful when maybe it wasn't. </dt><dd></dd>
									<dd>&emsp;&emsp; - some side effects may not be saved due to out of order writes </dd>
									<dd>&emsp;&emsp; -  </dd>
									<dt> Sources of this problem</dt><dd></dd>
									<dt> -  Power Loss </dt>
									<dt> -  Disk crash </dt>
									<dt> -  Suddend Disconnection </dt>
									<dd>&emsp;&emsp; Never leave data in an invalid state. For example, don't initialize an inode with a negative file size.</dd>
									
									<dt>3. All reference data blocks are marked used in the bitmap.</dt>
									<dd></dd>
									
									<dt>4. All unreferenced data blocks are marked free in bitmap.</dt>
									<dd></dd>
								</dl>
							</div>
						</section>
					<!-- Just add more of these sections -->
						<section >
							<div class="container">
								<h3>Things I Can Do</h3>
								<p>Integer eu ante ornare amet commetus vestibulum blandit integer in curae ac faucibus integer non. Adipiscing cubilia elementum integer lorem ipsum dolor sit amet.</p>
								
							</div>
						</section>

					<!-- Three -->
						<section id="three">
							<div class="container">
								<h3>A Few Accomplishments</h3>
								<p>Integer eu ante ornare amet commetus vestibulum blandit integer in curae ac faucibus integer non. Adipiscing cubilia elementum integer. Integer eu ante ornare amet commetus.</p>
								<div class="features">
									<article>
										<a href="#" class="image"><img src="images/pic01.jpg" alt="" /></a>
										<div class="inner">
											<h4>Possibly broke spacetime</h4>
											<p>Integer eu ante ornare amet commetus vestibulum blandit integer in curae ac faucibus integer adipiscing ornare amet.</p>
										</div>
									</article>
									<article>
										<a href="#" class="image"><img src="images/pic02.jpg" alt="" /></a>
										<div class="inner">
											<h4>Terraformed a small moon</h4>
											<p>Integer eu ante ornare amet commetus vestibulum blandit integer in curae ac faucibus integer adipiscing ornare amet.</p>
										</div>
									</article>
									<article>
										<a href="#" class="image"><img src="images/pic03.jpg" alt="" /></a>
										<div class="inner">
											<h4>Snapped dark matter in the wild</h4>
											<p>Integer eu ante ornare amet commetus vestibulum blandit integer in curae ac faucibus integer adipiscing ornare amet.</p>
										</div>
									</article>
								</div>
							</div>
						</section>
						
				</div>

			<!-- Footer -->
				<section id="footer">
					<div class="container">
						<ul class="copyright">
							<li>GNU General Public License</li>
						</ul>
					</div>
				</section>

		</div>
	</body>
</html>
